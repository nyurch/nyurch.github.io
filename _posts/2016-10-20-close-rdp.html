---
layout: post
title: Боротьба з незакритими RDP-сеансами.
category: [WINDOWS]
---
		<img class="head" src="/media/Remote-Desktop-Connection-Manager.png" alt="">
		<p>Як правило людці просто закривають вікно rdp-сеансу, замість того щоб розлогінитися. Сам такий. В результаті при	неналаштованих групових політиках
		рано чи пізно хтось не зможе зайти поки не будуть примусово відключені інші сеанси. Автоматично вирішити	проблему можна налаштувавши <b>GPO</b>, або запускаючи
		відключення за розкладом.<!--more--></p><p>Перший варіант очевидно більш пристойний, але не прийнятний для несерверних ОС бо там навіть при встановленому adminpack
		немає консолі <term>Terminal Services Configuration</term>.<br>
		Отже варіант <b>GPO</b> та варіант відключення за розкладом:<br>
		1) Відкриваємо консоль <term>Terminal Services Configuration</term>, переходимо в розділ <path>Connections</path> і
		дивимося властивості <b>RDP-Tcp</b>, конкретно закладку <b>Sessions</b> і виставляємо бажаний час для параметрів <path>End a disconnected session</path>, <path>Active session limit</path> та
		<path>Idle session limit</path>.	Налаштування не будуть застосовані до активних на даний момент сесій.<br>
		2) Створюємо cmd-файл з наступним змістом:</p>
		<xmp class="lst">FOR /L %%i IN (0,1,9) DO echo Y | rwinsta %%i /Server:назва_сервера</xmp>
		<p>Тут використано те що <b>id</b> кожній сесії присвоюються за порядком від 0 і далі, тому такий варіант просто відключає сесії з <b>id</b> від 0 до 9. Можна ускладнити
		визначаючи <b>id</b> лише для певних	юзерів записаних у текстовий файл, а потім відключаючи лише їх. Далі додаємо файл в планувальник завдань і виконуємо
		наприклад кожного дня після закінчення робочого часу.</p>
